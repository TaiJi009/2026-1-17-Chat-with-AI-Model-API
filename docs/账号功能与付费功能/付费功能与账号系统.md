# 付费功能与账号系统集成文档

## 项目概述

在现有AI聊天应用基础上，集成完整的账号系统和付费系统，实现：

- **账号系统**: 支持手机号验证码登录/注册
- **付费系统**: 微信支付扫码支付，10元/月订阅Pro功能
- **功能权限**: 夜间模式（dark）免费，日间模式（light）为Pro功能
- **数据存储**: 保持localStorage兼容，支持云端数据同步（可选）

### 技术栈

| 组件 | 技术栈 |
|------|--------|
| 前端 | React 18 + TypeScript + Vite + Tailwind CSS |
| 后端 | Node.js + Express + TypeScript |
| 数据库 | PostgreSQL (Docker容器) |
| 部署 | Docker + Docker Compose |
| 认证 | JWT Token |
| 支付 | 微信支付 Native支付（扫码） |
| 短信 | 腾讯云短信服务 |

---

## 文档索引

本文档已按功能模块拆分为以下详细文档，点击链接查看具体内容：

### 1. [项目概述](./01-项目概述.md)
功能目标和技术选型说明，包括账号系统、付费系统的核心功能定义。

### 2. [技术架构](./02-技术架构.md)
系统架构图和数据流向图，展示前端、后端、数据库和外部服务的交互关系。

### 3. [系统流程](./03-系统流程.md)
用户登录流程、支付流程和主题切换权限控制流程的详细流程图。

### 4. [数据库设计](./04-数据库设计.md)
用户表、订单表、短信验证码表的完整SQL定义和数据库关系图。

### 5. [API接口文档](./05-API接口文档.md)
认证相关接口（发送验证码、登录、获取用户信息）和支付相关接口（创建订单、查询状态）的完整API文档。

### 6. [前端实现](./06-前端实现.md)
前端代码实现指南，包括AuthContext、ThemeToggle权限控制、PaymentModal等核心组件的代码示例。

### 7. [后端实现](./07-后端实现.md)
后端项目结构、JWT认证中间件、支付服务实现等核心代码示例。

### 8. [部署指南](./08-部署指南.md)
Docker环境准备、Docker Compose配置、Nginx反向代理配置和部署步骤。

### 9. [安全考虑](./09-安全考虑.md)
认证安全、数据安全、支付安全、接口安全和Docker安全的最佳实践。

### 10. [开发步骤](./10-开发步骤.md)
分阶段开发计划，包括后端基础架构、认证系统、支付系统、前端集成等7个阶段的详细步骤。

---

## 快速开始

1. **了解项目**: 阅读 [项目概述](./01-项目概述.md) 了解功能目标
2. **理解架构**: 查看 [技术架构](./02-技术架构.md) 和 [系统流程](./03-系统流程.md)
3. **数据库设计**: 参考 [数据库设计](./04-数据库设计.md) 创建表结构
4. **API开发**: 按照 [API接口文档](./05-API接口文档.md) 实现接口
5. **前端开发**: 参考 [前端实现](./06-前端实现.md) 和 [后端实现](./07-后端实现.md)
6. **部署上线**: 遵循 [部署指南](./08-部署指南.md) 进行部署
7. **安全加固**: 参考 [安全考虑](./09-安全考虑.md) 进行安全配置

---

## 开发时间规划

按照 [开发步骤](./10-开发步骤.md) 的规划，预计总开发时间为 **18-25天**：

- 阶段1: 后端基础架构 (3-4天)
- 阶段2: 认证系统 (3-4天)
- 阶段3: 支付系统 (4-5天)
- 阶段4: 前端集成 (3-4天)
- 阶段5: 部署配置 (2-3天)
- 阶段6: 测试和优化 (2-3天)
- 阶段7: 文档编写 (1-2天)

---

**最后更新**: 2026-01-19  
**文档版本**: v1.0
