# 04-运行数据库迁移

## 步骤说明

这是快速开始的第四步：运行数据库迁移，初始化数据库表结构。

## 运行迁移

等待容器完全启动后（约1-2分钟），运行数据库迁移：

```bash
docker-compose exec backend npm run migrate
```

这个命令会：
- 连接到 PostgreSQL 数据库
- 执行迁移脚本，创建必要的表结构
- 初始化数据库

## 迁移内容

迁移脚本会创建以下表：
- `users` - 用户表
- `orders` - 订单表
- 其他必要的索引和约束

## 验证迁移

迁移完成后，可以进入数据库验证：

```bash
docker-compose exec postgres psql -U user -d chat_app -c "\dt"
```

这会列出所有已创建的表。

## 常见问题

### 迁移失败：数据库连接错误

如果出现连接错误，可能是：
1. 数据库容器还未完全启动，等待片刻后重试
2. 环境变量配置错误，检查 `.env` 文件中的数据库配置

### 迁移失败：表已存在

如果表已存在，迁移脚本通常会跳过，不会报错。如果需要重新创建，需要先删除现有表。

## 下一步

迁移完成后，继续下一步：[05-验证部署](./05-验证部署.md)
