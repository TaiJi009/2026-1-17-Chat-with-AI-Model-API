# 自定义域名

Railway 支持为您的服务配置自定义域名，并自动提供 SSL 证书。

## 添加自定义域名

1. 在服务 **Settings → Domains** 页面
2. 点击 **"Add Domain"**
3. 输入您的域名（如 `api.yourdomain.com`）
4. Railway 会提供 DNS 配置说明
5. 在您的域名 DNS 设置中添加 CNAME 记录
6. Railway 会自动配置 SSL 证书（通常需要几分钟）

## DNS 配置

Railway 会提供以下信息：

- **CNAME 记录**：指向 Railway 提供的域名
- **目标地址**：Railway 服务的默认域名

### 配置步骤

1. 登录您的域名注册商或 DNS 服务提供商
2. 进入 DNS 管理页面
3. 添加 CNAME 记录：
   - **名称**：`api`（或您想要的子域名）
   - **类型**：`CNAME`
   - **值**：Railway 提供的目标地址
   - **TTL**：`3600`（或默认值）

## 更新环境变量

添加自定义域名后，需要更新相关环境变量：

- `CORS_ORIGIN`: 更新为新的前端域名
- `WECHAT_NOTIFY_URL`: 更新为新的回调 URL

### 示例

```env
# 更新 CORS 允许的来源
CORS_ORIGIN=https://your-frontend-domain.com

# 更新微信支付回调 URL
WECHAT_NOTIFY_URL=https://api.yourdomain.com/api/payment/wechat/callback
```

## 验证域名

添加域名后，Railway 会显示验证状态：

- **Pending**: 等待 DNS 配置生效
- **Validating**: 正在验证域名
- **Active**: 域名已激活，可以使用

等待 DNS 传播完成后（通常几分钟到几小时），域名就可以使用了。

## SSL 证书

Railway 会自动为您的自定义域名配置 SSL 证书：

- 自动申请 Let's Encrypt 证书
- 自动续期证书
- 支持 HTTPS 访问

## 多个域名

您可以为同一个服务添加多个域名：

1. 在 **Domains** 页面
2. 点击 **"Add Domain"**
3. 添加另一个域名
4. 配置相应的 DNS 记录

## 删除域名

如果需要删除域名：

1. 在 **Domains** 页面
2. 找到要删除的域名
3. 点击删除按钮
4. 确认删除

⚠️ **注意**：删除域名后，记得在 DNS 服务提供商处删除相应的 DNS 记录。

## 故障排查

如果域名无法访问：

1. **检查 DNS 配置**：
   - 确认 CNAME 记录已正确配置
   - 等待 DNS 传播完成（可能需要几小时）

2. **检查域名状态**：
   - 在 Railway 中查看域名验证状态
   - 确认域名已激活

3. **检查 SSL 证书**：
   - 确认 SSL 证书已成功申请
   - 等待证书配置完成

## 相关文档

- [环境变量配置](03-环境变量配置.md) - 更新环境变量
- [故障排查](09-故障排查.md) - 如果域名配置有问题，查看故障排查章节
